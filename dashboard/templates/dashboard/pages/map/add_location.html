
	    <div id="screen" style="position: fixed; width: 100%; height: 100%; top: 0; left: 0; background-color: rgba(0, 0, 0, 0.5); z-index: 999;"></div>
	    <div class="dialog" id="addPinModal">
	        <button id="closeDialog" style="float: right;">X</button>
	        <h2>Add Location</h2>
	        <form method="POST" hx-post="{% url 'add_pin' %}" hx-trigger="submit" hx-target="#map" hx-swap="outerHTML">
				<label for="name">Name:</label><br>
				<input type="text" id="name" name="name" autocomplete="name" required><br>
				<label for="latitude">Latitude:</label><br>
				<input type="text" id="latitude" name="latitude" autocomplete="latitude" pattern="^-?([1-8]?[1-9]|[1-9]0)\.{1}\d{1,6}" readonly><br> 
				<label for="longitude">Longitude:</label><br>
				<input type="text" id="longitude" name="longitude" autocomplete="longitude" pattern="^-?([1-8]?[1-9]|[1-9]0)\.{1}\d{1,6}" readonly><br>
				<label for="address">Address:</label><br>
				<input type="text" id="address" name="address" autocomplete="address" pattern="^[a-zA-Z0-9\s,.' -]*$"><br>
				<div id="iconGrid" class="icon-grid">
					<i class="bank"></i>
					<i class="car"></i>
					<i class="church"></i>
					<i class="firehouse"></i>
					<i class="hospital"></i>
					<i class="military"></i>
					<i class="plane"></i>
					<i class="school"></i>
					<i class="tunnel"></i>
					<i class="boat"></i>
					<i class="castle"></i>
					<i class="dam"></i>
					<i class="graffiti"></i>
					<i class="house"></i>
					<i class="museum"></i>
					<i class="powerplant"></i>
					<i class="statue"></i>
					<i class="bridge"></i>
					<i class="cave"></i>
					<i class="factory"></i>
					<i class="graveyard"></i>
					<i class="library"></i>
					<i class="park"></i>
					<i class="prison"></i>
					<i class="train"></i>
					<!-- 
					<i class="windmill"></i>
					<i class="lighthouse"></i>
					<i class="water-tower"></i>
					<i class="barn"></i>
					<i class="silo"></i>
					<i class="police-station"></i>
					<i class="farm"></i>
					<i class="stadium"></i>
					<i class="theater"></i>
					<i class="construction"></i>
					-->
				</div>
				<input type="hidden" id="selectedIcon" name="icon">

				<input type="submit" value="Submit" class="submit-button">
	        </form>

			<script>
				function closeDialog() {
					const dialog = document.getElementById('addPinModal');
					const screen = document.getElementById('screen');

					if (window.pin) {
						console.log('Removing most recent pin')
						console.log('map ', window.map);
						console.log('pin ', window.pin);
						window.pin.remove();
						window.pin.closePopup();
						window.pin.closeTooltip();
						window.map.removeLayer(window.pin);
						window.pin = null;
					}

					if (screen) {
						screen.style.display = 'none';
						screen.remove();
					}
					dialog.style.display = 'none';
				}

				function initializeDialog() {
					const iconGrid = document.getElementById('iconGrid');
					const selectedIconInput = document.getElementById('selectedIcon');
					const dialog = document.getElementById('addPinModal');
					const screen = document.getElementById('screen');
					const closeDialogButton = document.getElementById('closeDialog');

					iconGrid.addEventListener('click', (e) => {
						if (e.target.tagName === 'I') {
							selectedIconInput.value = e.target.dataset.value;
						}
					});

					screen.addEventListener('click', () => closeDialog());
					closeDialogButton.addEventListener('click', () => closeDialog());
				}
				document.addEventListener('dialogLoaded', () => initializeDialog());		
			</script>

	    </div>
